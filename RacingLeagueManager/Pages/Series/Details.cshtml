@page
@model RacingLeagueManager.Pages.Series.DetailsModel

@{
    ViewData["Title"] = "Details";
    Layout = "~/Pages/Shared/_Layout.cshtml";
}

<h3>@Html.DisplayFor(model => model.Series.Name)</h3>

<div>
    <a asp-page="../SeriesDriver/Index" asp-route-seriesId="@Model.Series.Id">Roster</a> |
    <a asp-page="../Team/Index" asp-route-seriesId="@Model.Series.Id">Teams</a> |
    <a asp-page="/SeriesEntryDriver/Index" asp-route-seriesId="@Model.Series.Id">Drivers</a> |
    <a asp-page="/SeriesEntry/Index" asp-route-seriesId="@Model.Series.Id">Standings</a>


    <hr />

    <div class="panel panel-default">
        <div class="panel-heading">




            <div class="row">


                @if (Model.IsJoinable)
                {
                    <div class="col-md-10">
                        <strong>Details</strong>
                    </div>
                    <div class="col-md-1 text-right">
                        <a asp-page="./Edit" asp-route-id="@Model.Series.Id">Edit</a>
                    </div>
                    <div class="col-md-1 text-right">
                        <form method="post" asp-page-handler="join" asp-route-seriesId="@Model.Series.Id">
                            <button type="submit" style="display:inline;margin:0px;padding:0px;margin-bottom:0px" class="btn btn-link">Join Series</button>
                        </form>
                    </div>

                }
                else
                {
                    <div class="col-md-11">
                        <strong>Details</strong>
                    </div>
                    <div class="col-md-1 text-right">
                        <a asp-page="./Edit" asp-route-id="@Model.Series.Id">Edit</a>
                    </div>

                }
            </div>


               

            

        </div>
        <div class="panel-body">
            <div class="row">
                <div class="col-md-12"><span class="font-bold"><strong>@Html.DisplayNameFor(model => model.Series.Description):</strong></span> @Html.DisplayFor(model => model.Series.Description)</div>
            </div>
            <div class="row">
                <div class="col-md-12"><span class="font-bold"><strong>@Html.DisplayNameFor(model => model.Series.Owner):</strong></span> @Html.DisplayFor(model => model.Series.Owner.UserName)</div>
            </div>
        </div>
    </div>


    <div class="panel panel-default">
        <div class="panel-heading">
            <div class="row">
                <div class="col-md-10"><strong>Race Schedule</strong></div>
                <div class="col-md-2 text-right"><a asp-page="../Race/Create" asp-route-seriesId="@Model.Series.Id">Add Race</a></div>
            </div>
        </div>
        <div class="panel-body">
            <table class="table">
                <tr>
                    <th>Date</th>
                    <th>Track</th>
                    <th>Laps</th>
                    <th>Status</th>
                </tr>
                @foreach (var item in Model.Series.Races.OrderBy(r => r.RaceDate))
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.RaceDate)
                        </td>
                        <td>
                            <a asp-page="../Race/Details" asp-route-id="@item.Id">@Html.DisplayFor(modelItem => item.Track.Name)</a>
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Laps)
                        </td>
                        <td>
                            <span class="@Model.GetStatusCssClass(item.Status)">@Html.DisplayFor(modelItem => item.Status)</span>
                        </td>
                    </tr>
                }
            </table>
        </div>
    </div>






    @*<dl>
            <dt>@Html.DisplayNameFor(model => model.Series.Owner)</dt>
            <dd>@Html.DisplayFor(model => model.Series.Owner.UserName)</dd>
            <dt>@Html.DisplayNameFor(model => model.Series.Description)</dt>
            <dd>@Html.DisplayFor(model => model.Series.Description)</dd>

        </dl>*@


    @*

        MOVE TO NEW SECTION

    *@

    @*<h3>Entries</h3>

        <table class="table">
            <tr>
                <th>Team</th>
                <th>Number</th>
                <th>Car</th>
                <th>Drivers</th>

            </tr>
            @foreach (var item in Model.Series.SeriesEntries)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.Team.Name)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.RaceNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Car.Name)
                    </td>
                    <td>
                        @if (item.SeriesEntryDrivers != null)
                        {
                            for (int i = 0; i < item.SeriesEntryDrivers.Count; i++)
                            {
                                @Html.DisplayFor(modelItem => item.SeriesEntryDrivers.ElementAt(i).LeagueDriver.Driver.UserName)
                                if ((item.SeriesEntryDrivers.Count - i) > 1)
                                {
                                    @Html.Raw(",<br />");
                                }
                            }
                        }
                    </td>
                </tr>
            }
        </table>*@

    @*

        END MOVE
    *@


</div>
<div>
    <a asp-page="./Edit" asp-route-id="@Model.Series.Id">Edit</a> |
    <a asp-page="../Leagues/Details" asp-route-id="@Model.Series.LeagueId">Back to League</a>
</div>
